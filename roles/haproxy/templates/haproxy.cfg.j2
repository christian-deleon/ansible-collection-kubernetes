defaults
    mode tcp
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms

frontend kubernetes-frontend
    bind *:8443
    default_backend kubernetes-backend

backend kubernetes-backend
    balance roundrobin
    {% for server in groups['controlplane'] %}
    server {{ hostvars[server]['ansible_hostname'] }} {{ hostvars[server]['ansible_host'] }}:6443 check
    {% endfor %}
